// This function draws the ascii version
function convert() {
    var brightness_table = ["0.820509803921569", "0.860392156862745", "0.531450980392157", "0.611058823529412", "0.511254901960785", "0.541176470588236", "0.930196078431373", "0.85043137254902", "0.830470588235294", "0.84043137254902", "0.820549019607843", "0.960117647058824", "0.920235294117647", "0.960156862745098", "0.830470588235294", "0.651019607843137", "0.780666666666667", "0.631137254901961", "0.641098039215686", "0.690666666666667", "0.641098039215686", "0.601058823529412", "0.750862745098039", "0.591137254901961", "0.59121568627451", "0.920313725490196", "0.920274509803922", "0.800627450980392", "0.760941176470588", "0.78078431372549", "0.740823529411765", "0.411372549019608", "0.621176470588235", "0.541098039215687", "0.601098039215687", "0.560941176470589", "0.581176470588236", "0.680745098039216", "0.491294117647059", "0.580627450980392", "0.82043137254902", "0.740509803921569", "0.580862745098039", "0.76043137254902", "0.451333333333334", "0.520627450980392", "0.581019607843137", "0.640901960784314", "0.481333333333334", "0.550980392156863", "0.591098039215686", "0.720509803921569", "0.610627450980392", "0.640862745098039", "0.51121568627451", "0.610941176470588", "0.710941176470588", "0.60121568627451", "0.890117647058824", "0.820470588235294", "0.800705882352941", "0.83043137254902", "1", "0.930117647058823", "0.680980392156863", "0.680705882352941", "0.700745098039216", "0.631058823529412", "0.670941176470588", "0.76078431372549", "0.670901960784314", "0.670705882352941", "0.82043137254902", "0.820235294117647", "0.690627450980392", "0.820156862745098", "0.551254901960785", "0.710666666666667", "0.730627450980392", "0.710588235294118", "0.670901960784314", "0.840274509803922", "0.660901960784314", "0.79043137254902", "0.700705882352941", "0.760627450980392", "0.581137254901961", "0.710745098039216", "0.750745098039216", "0.700980392156863", "0.790666666666667", "0.910352941176471", "0.780705882352941", "0.830470588235294", "0.601098039215687", "0.640941176470588", "0.611176470588235", "0.591254901960785", "0.601294117647059", "0.631176470588235", "0.60121568627451", "0.700745098039216", "0.571254901960785", "0.591254901960784", "0.621137254901961", "0.780666666666667", "0.760549019607843", "0.810549019607843", "0.581333333333333", "0.581294117647059", "0.561254901960785", "0.451607843137256", "0.481843137254903", "0.630941176470588", "0.650941176470588", "0.680823529411765", "0.610980392156863", "0.650901960784314", "0.671058823529412", "0.541176470588236", "0.590705882352941", "0.640980392156863", "0.611176470588235", "0.411686274509805", "0.780705882352941", "0.770705882352941", "0.62121568627451", "0.800588235294118", "0.670862745098039", "0.640941176470588", "0.581058823529412", "0.480745098039216", "0.810666666666667", "0.830392156862745", "0.84043137254902", "0.391882352941177", "0.860470588235294", "0.571294117647059", "0.551411764705883", "0.860313725490196", "0.740705882352941", "0.760627450980392", "0.381372549019608", "0.140392156862745", "0.103411764705883", "0.800392156862745", "0.740588235294118", "0.601254901960784", "0.581254901960784", "0.61121568627451", "0.391843137254903", "0.521019607843138", "0.60078431372549", "0.680705882352941", "0.600901960784314", "0.670705882352941", "0.581137254901961", "0.840352941176471", "0.780470588235294", "0.720627450980392", "0.760470588235294", "0.720549019607843", "0.820352941176471", "0.660745098039216", "0.551372549019608", "0.581294117647059", "0.560941176470589", "0.640588235294118", "0.481098039215687", "0.560823529411765", "0.480980392156863", "0.640705882352941", "0.40121568627451", "0.710941176470588", "0.600901960784314", "0.501411764705883", "0.541294117647059", "0.541333333333334", "0.57121568627451", "0.860352941176471", "0.800509803921569", "0.780549019607843", "0.780588235294118", "0.800470588235294", "0.820313725490196", "0.1", "0.640352941176471", "0.920313725490196", "0.810470588235294", "0.37", "0.561098039215686", "0.631058823529412", "0.541137254901961", "0.571058823529412", "0.601019607843137", "0.541137254901961", "0.700745098039216", "0.700549019607843", "0.650862745098039", "0.590705882352941", "0.570745098039216", "0.600666666666667", "0.690980392156863", "0.691019607843137", "0.860470588235294", "0.940196078431373", "1", "0.681176470588235", "1", "0.47164705882353", "0.54121568627451", "0.621176470588235", "0.820705882352941", "0.980078431372549", "0.880470588235294", "0.92", "0.96", "0.910235294117647", "0.820549019607843", "0.820588235294118", "0.700392156862745"]
    var character_table = ["!", "\"", "#", "$", "%", "&", "'", "(", ")", "*", "+", ",", "-", ".", "/", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", ":", ";", "<", "=", ">", "?", "@", "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "[", "\\", "]", "^", "_", "`", "a", "b", "c", "d", "e", "f", "g", "h", "I", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "{", "|", "}", "~", "Ç", "ü", "é", "â", "ä", "à", "å", "ç", "ê", "ë", "è", "ï", "î", "ì", "Ä", "Å", "É", "æ", "Æ", "ô", "ö", "ò", "û", "ù", "ÿ", "Ö", "Ü", "ø", "£", "Ø", "×", "ƒ", "á", "í", "ó", "ú", "ñ", "Ñ", "ª", "º", "¿", "®", "¬", "½", "¼", "¡", "«", "»", "░", "▒", "▓", "│", "┤", "Á", "Â", "À", "©", "╣", "║", "╗", "╝", "¢", "¥", "┐", "└", "┴", "┬", "├", "─", "┼", "ã", "Ã", "╚", "╔", "╩", "╦", "╠", "═", "╬", "¤", "ð", "Ð", "Ê", "Ë", "È", "ı", "Í", "Î", "Ï", "┘", "┌", "█", "▄", "¦", "Ì", "▀", "Ó", "ß", "Ô", "Ò", "õ", "Õ", "µ", "þ", "Þ", "Ú", "Û", "Ù", "ý", "Ý", "¯", "´", "­", "±", "‗", "¾", "¶", "§", "÷", "¸", "°", "¨", "·", "¹", "³", "²", "■"];
    // pix now contains image rgb values
    // : 255, 255, 255, 255, 255, 255, 255

    var resolution = 5; // Resolution is calculated as follows: Scan every [resolution] pixel; Higher number is lower resolution
    var TIJDELIJK= [];

    for (var w = 0; w < canvas.width; w += resolution) {
        for (var h = 0; h < canvas.height; h += resolution) {

            var image_pixel = context_canvas.getImageData(w, h, 1, 1);
            var pixel_data = image_pixel.data;

            var R = pixel_data[0];
            var G = pixel_data[1];
            var B = pixel_data[2];
            // ALPHA = pixel_data[3];

            // Calculate pixel brightness (perceived luminance) / 255 so we get a value between 0 and 1;

            var current = (0.2126*R + 0.7152*G + 0.0722*B) / 255; //(0.299 * R + 0.587 * G + 0.114 * B) / 255;

            var distance = 5;
            var result;

            for (var i = 0; i < brightness_table.length; i++) {
                var curDistance = Math.abs(parseFloat(brightness_table[i]) - current);
                if (curDistance < distance) {
                    distance = curDistance;
                    result = i;
                }
            }
            context_result.font="5px Arial";
            context_result.fillStyle="rgb(" + R + "," + G + "," + B + ")";
            context_result.fillText(character_table[result],w,h);

            TIJDELIJK.push(character_table[result]);
        }
    }

    console.log(TIJDELIJK);

}